<!DOCTYPE HTML>
<html lang="zh-Hans" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Defining Modules to Control Scope and Privacy 定义模块以控制作用域与私有性 - Rust 编程语言</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="ferris.css">
        <link rel="stylesheet" href="theme/2018-edition.css">
        <link rel="stylesheet" href="theme/semantic-notes.css">
        <link rel="stylesheet" href="theme/listing.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust 编程语言</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="defining-modules-to-control-scope-and-privacy-定义模块以控制作用域与私有性"><a class="header" href="#defining-modules-to-control-scope-and-privacy-定义模块以控制作用域与私有性">Defining Modules to Control Scope and Privacy 定义模块以控制作用域与私有性</a></h2>
<p>In this section, we’ll talk about modules and other parts of the module system,
namely <em>paths</em>, which allow you to name items; the <code>use</code> keyword that brings a
path into scope; and the <code>pub</code> keyword to make items public. We’ll also discuss
the <code>as</code> keyword, external packages, and the glob operator.</p>
<p>本节我们将讨论模块及模块系统的其他部分：<strong>路径</strong>（用于命名条目）、<code>use</code> 关键字（将路径引入作用域）、<code>pub</code> 关键字（公开条目）。同时涵盖 <code>as</code> 关键字、外部包和通配符操作符。</p>
<h3 id="modules-cheat-sheet-模块速查表"><a class="header" href="#modules-cheat-sheet-模块速查表">Modules Cheat Sheet 模块速查表</a></h3>
<p>Before we get to the details of modules and paths, here we provide a quick
reference on how modules, paths, the <code>use</code> keyword, and the <code>pub</code> keyword work
in the compiler, and how most developers organize their code. We’ll be going
through examples of each of these rules throughout this chapter, but this is a
great place to refer to as a reminder of how modules work.</p>
<p>在深入模块与路径细节前，先提供关于模块、路径、<code>use</code> 和 <code>pub</code> 在编译器中如何运作的快速参考，以及开发者的常见代码组织方式。本章后续将通过示例演示这些规则，此处可作为模块工作机制的备忘指南。</p>
<ul>
<li><strong>Start from the crate root</strong>: When compiling a crate, the compiler first
looks in the crate root file (usually <em>src/lib.rs</em> for a library crate or
<em>src/main.rs</em> for a binary crate) for code to compile.</li>
<li><strong>从箱根开始</strong>：编译箱时，编译器首先在箱根文件（库箱通常是 <em>src/lib.rs</em>，二进制箱是 <em>src/main.rs</em>）中查找待编译代码。</li>
<li><strong>Declaring modules</strong>: In the crate root file, you can declare new modules;
say you declare a “garden” module with <code>mod garden;</code>. The compiler will look
for the module’s code in these places:</li>
<li><strong>声明模块</strong>：在箱根文件中，可用 <code>mod garden;</code> 声明新模块。编译器会在以下位置查找模块代码：
<ul>
<li>Inline, within curly brackets that replace the semicolon following <code>mod garden</code></li>
<li>在 <code>mod garden</code> 后的花括号内（替代分号）</li>
<li>In the file <em>src/garden.rs</em></li>
<li>在文件 <em>src/garden.rs</em></li>
<li>In the file <em>src/garden/mod.rs</em></li>
<li>在文件 <em>src/garden/mod.rs</em></li>
</ul>
</li>
<li><strong>Declaring submodules</strong>: In any file other than the crate root, you can
declare submodules. For example, you might declare <code>mod vegetables;</code> in
<em>src/garden.rs</em>. The compiler will look for the submodule’s code within the
directory named for the parent module in these places:</li>
<li><strong>声明子模块</strong>：在箱根外的任何文件中，可声明子模块（如 <em>src/garden.rs</em> 中的 <code>mod vegetables;</code>）。编译器会在父模块同名目录的以下位置查找子模块代码：
<ul>
<li>Inline, directly following <code>mod vegetables</code>, within curly brackets instead
of the semicolon</li>
<li>紧接 <code>mod vegetables</code> 后的花括号内（替代分号）</li>
<li>In the file <em>src/garden/vegetables.rs</em></li>
<li>在文件 <em>src/garden/vegetables.rs</em></li>
<li>In the file <em>src/garden/vegetables/mod.rs</em></li>
<li>在文件 <em>src/garden/vegetables/mod.rs</em></li>
</ul>
</li>
<li><strong>Paths to code in modules</strong>: Once a module is part of your crate, you can
refer to code in that module from anywhere else in that same crate, as long
as the privacy rules allow, using the path to the code. For example, an
<code>Asparagus</code> type in the garden vegetables module would be found at
<code>crate::garden::vegetables::Asparagus</code>.</li>
<li><strong>模块内代码的路径</strong>：只要符合私有性规则，模块成为箱的一部分后，可通过路径在箱内任意位置引用其代码。例如，garden vegetables 模块中的 <code>Asparagus</code> 类型位于 <code>crate::garden::vegetables::Asparagus</code>。</li>
<li><strong>Private vs. public</strong>: Code within a module is private from its parent
modules by default. To make a module public, declare it with <code>pub mod</code>
instead of <code>mod</code>. To make items within a public module public as well, use
<code>pub</code> before their declarations.</li>
<li><strong>私有 vs 公有</strong>：模块内代码默认对其父模块私有。使用 <code>pub mod</code> 替代 <code>mod</code> 可公开模块。对公有模块中的条目使用 <code>pub</code> 可进一步公开它们。</li>
<li><strong>The <code>use</code> keyword</strong>: Within a scope, the <code>use</code> keyword creates shortcuts to
items to reduce repetition of long paths. In any scope that can refer to
<code>crate::garden::vegetables::Asparagus</code>, you can create a shortcut with <code>use crate::garden::vegetables::Asparagus;</code> and from then on you only need to
write <code>Asparagus</code> to make use of that type in the scope.</li>
<li><strong><code>use</code> 关键字</strong>：在作用域内，<code>use</code> 为条目创建快捷方式以减少长路径重复。在能访问 <code>crate::garden::vegetables::Asparagus</code> 的作用域中，使用 <code>use crate::garden::vegetables::Asparagus;</code> 创建快捷方式后，只需写 <code>Asparagus</code> 即可使用该类型。</li>
</ul>
<p>Here, we create a binary crate named <code>backyard</code> that illustrates these rules.
The crate’s directory, also named <code>backyard</code>, contains these files and
directories:</p>
<p>以下示例创建了名为 <code>backyard</code> 的二进制箱，目录结构如下：</p>
<pre><code class="language-text">backyard
├── Cargo.lock
├── Cargo.toml
└── src
    ├── garden
    │   └── vegetables.rs
    ├── garden.rs
    └── main.rs
</code></pre>
<p>The crate root file in this case is <em>src/main.rs</em>, and it contains:</p>
<p>此处的箱根文件是 <em>src/main.rs</em>，其内容为：</p>
<figure class="listing">
<span class="file-name">Filename: src/main.rs</span>
<pre><code class="language-rust noplayground ignore">use crate::garden::vegetables::Asparagus;

pub mod garden;

fn main() {
    let plant = Asparagus {};
    println!("I'm growing {plant:?}!");
}</code></pre>
</figure>
<p>The <code>pub mod garden;</code> line tells the compiler to include the code it finds in
<em>src/garden.rs</em>, which is:</p>
<p><code>pub mod garden;</code> 指示编译器包含 <em>src/garden.rs</em> 的代码：</p>
<figure class="listing">
<span class="file-name">Filename: src/garden.rs</span>
<pre><code class="language-rust noplayground ignore">pub mod vegetables;</code></pre>
</figure>
<p>Here, <code>pub mod vegetables;</code> means the code in <em>src/garden/vegetables.rs</em> is
included too. That code is:</p>
<p>此处的 <code>pub mod vegetables;</code> 意味着也包含 <em>src/garden/vegetables.rs</em> 的代码：</p>
<pre><code class="language-rust noplayground ignore">#[derive(Debug)]
pub struct Asparagus {}</code></pre>
<p>Now let’s get into the details of these rules and demonstrate them in action!</p>
<p>现在让我们深入探讨这些规则并演示其实际应用！</p>
<h3 id="grouping-related-code-in-modules-在模块中组织相关代码"><a class="header" href="#grouping-related-code-in-modules-在模块中组织相关代码">Grouping Related Code in Modules 在模块中组织相关代码</a></h3>
<p><em>Modules</em> let us organize code within a crate for readability and easy reuse.
Modules also allow us to control the <em>privacy</em> of items because code within a
module is private by default. Private items are internal implementation details
not available for outside use. We can choose to make modules and the items
within them public, which exposes them to allow external code to use and depend
on them.</p>
<p><strong>模块</strong>让我们在箱内组织代码以提高可读性和复用性。模块还通过默认私有性控制条目的<strong>可见性</strong>——模块内代码默认私有。私有条目是内部实现细节，不对外部开放。我们可选择将模块及其内部条目设为公有（<code>pub</code>），从而允许外部代码使用和依赖它们。</p>
<p>As an example, let’s write a library crate that provides the functionality of a
restaurant. We’ll define the signatures of functions but leave their bodies
empty to concentrate on the organization of the code rather than the
implementation of a restaurant.</p>
<p>例如，我们将编写一个提供餐厅功能的库箱。先定义函数签名而不实现具体逻辑，以便专注于代码组织而非餐厅实现细节。</p>
<p>In the restaurant industry, some parts of a restaurant are referred to as
<em>front of house</em> and others as <em>back of house</em>. Front of house is where
customers are; this encompasses where the hosts seat customers, servers take
orders and payment, and bartenders make drinks. Back of house is where the
chefs and cooks work in the kitchen, dishwashers clean up, and managers do
administrative work.</p>
<p>餐饮业中，餐厅分为<strong>前厅</strong>（front of house）和<strong>后厨</strong>（back of house）。前厅接待顾客，包含领位区、服务员处理点单/付款区、调酒师制作饮品区；后厨是厨师工作区，包含洗碗区和管理员办公区。</p>
<p>To structure our crate in this way, we can organize its functions into nested
modules. Create a new library named <code>restaurant</code> by running <code>cargo new restaurant --lib</code>. Then enter the code in Listing 7-1 into <em>src/lib.rs</em> to
define some modules and function signatures; this code is the front of house
section.</p>
<p>为按此结构组织箱，我们将函数分层嵌套到模块中。运行 <code>cargo new restaurant --lib</code> 创建名为 <code>restaurant</code> 的新库。将示例 7-1 的代码写入 <em>src/lib.rs</em> 以定义模块和函数签名（这部分代码对应前厅模块）：</p>
<figure class="listing" id="listing-7-1">
<span class="file-name">Filename: src/lib.rs</span>
<pre><code class="language-rust noplayground">mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}

        fn seat_at_table() {}
    }

    mod serving {
        fn take_order() {}

        fn serve_order() {}

        fn take_payment() {}
    }
}</code></pre>
<figcaption><a href="#listing-7-1">Listing 7-1</a>: A <code>front_of_house</code> module containing other modules that then contain functions 包含嵌套模块的 <code>front_of_house</code> 模块，模块内含有函数</figcaption>
</figure>
<p>We define a module with the <code>mod</code> keyword followed by the name of the module
(in this case, <code>front_of_house</code>). The body of the module then goes inside curly
brackets. Inside modules, we can place other modules, as in this case with the
modules <code>hosting</code> and <code>serving</code>. Modules can also hold definitions for other
items, such as structs, enums, constants, traits, and as in Listing 7-1,
functions.</p>
<p>使用 <code>mod</code> 关键字加模块名（此处为 <code>front_of_house</code>）定义模块，模块体位于花括号内。模块内可嵌套其他模块（如 <code>hosting</code> 和 <code>serving</code>）。模块也可包含其他条目定义，如结构体、枚举、常量、特性，以及如示例 7-1 所示的函数。</p>
<p>By using modules, we can group related definitions together and name why
they’re related. Programmers using this code can navigate the code based on the
groups rather than having to read through all the definitions, making it easier
to find the definitions relevant to them. Programmers adding new functionality
to this code would know where to place the code to keep the program organized.</p>
<p>通过模块，我们能将相关定义分组并标明关联性。使用此代码的程序员可按分组导航，无需通读所有定义，从而更易定位相关条目。新增功能时，开发者也能明确代码存放位置以保持组织性。</p>
<p>Earlier, we mentioned that <em>src/main.rs</em> and <em>src/lib.rs</em> are called crate
roots. The reason for their name is that the contents of either of these two
files form a module named <code>crate</code> at the root of the crate’s module structure,
known as the <em>module tree</em>.</p>
<p>前文提到 <em>src/main.rs</em> 和 <em>src/lib.rs</em> 称为箱根。其命名原因是：这两个文件的内容构成箱模块结构根部的 <code>crate</code> 模块，该结构称为<strong>模块树</strong>。</p>
<p>Listing 7-2 shows the module tree for the structure in Listing 7-1.</p>
<p>示例 7-2 展示了示例 7-1 结构的模块树：</p>
<figure class="listing" id="listing-7-2">
<pre><code class="language-text">crate
 └── front_of_house
     ├── hosting
     │   ├── add_to_waitlist
     │   └── seat_at_table
     └── serving
         ├── take_order
         ├── serve_order
         └── take_payment
</code></pre>
<figcaption><a href="#listing-7-2">Listing 7-2</a>: The module tree for the code in Listing 7-1 示例 7-1 代码的模块树</figcaption>
</figure>
<p>This tree shows how some of the modules nest inside other modules; for example,
<code>hosting</code> nests inside <code>front_of_house</code>. The tree also shows that some modules
are <em>siblings</em>, meaning they’re defined in the same module; <code>hosting</code> and
<code>serving</code> are siblings defined within <code>front_of_house</code>. If module A is
contained inside module B, we say that module A is the <em>child</em> of module B and
that module B is the <em>parent</em> of module A. Notice that the entire module tree
is rooted under the implicit module named <code>crate</code>.</p>
<p>此树展示了模块的嵌套关系（如 <code>hosting</code> 嵌套在 <code>front_of_house</code> 中）。同时显示某些模块是<strong>同级模块</strong>（定义在同一模块中），如 <code>hosting</code> 和 <code>serving</code> 都在 <code>front_of_house</code> 内定义。若模块 A 位于模块 B 内部，称 A 是 B 的<strong>子模块</strong>，B 是 A 的<strong>父模块</strong>。注意整个模块树植根于隐式的 <code>crate</code> 模块下。</p>
<p>The module tree might remind you of the filesystem’s directory tree on your
computer; this is a very apt comparison! Just like directories in a filesystem,
you use modules to organize your code. And just like files in a directory, we
need a way to find our modules.</p>
<p>模块树可能让你联想到计算机的文件系统目录树——这是非常贴切的类比！如同文件系统中的目录，我们用模块组织代码；如同目录中的文件，我们需要定位模块的路径。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch07-01-packages-and-crates.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch07-01-packages-and-crates.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="ferris.js"></script>



    </div>
    </body>
</html>
