<!DOCTYPE HTML>
<html lang="zh-Hans" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Control Flow 控制流 - Rust 编程语言</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="ferris.css">
        <link rel="stylesheet" href="theme/2018-edition.css">
        <link rel="stylesheet" href="theme/semantic-notes.css">
        <link rel="stylesheet" href="theme/listing.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust 编程语言</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="control-flow-控制流"><a class="header" href="#control-flow-控制流">Control Flow 控制流</a></h2>
<p>The ability to run some code depending on whether a condition is <code>true</code> and to
run some code repeatedly while a condition is <code>true</code> are basic building blocks
in most programming languages. The most common constructs that let you control
the flow of execution of Rust code are <code>if</code> expressions and loops.</p>
<p>根据条件是否为 <code>true</code> 来决定是否执行某段代码，以及在条件为 <code>true</code> 时重复执行某段代码的能力，是大多数编程语言的基本组成部分。在 Rust 中控制执行流的主要结构是 <code>if</code> 表达式和循环。</p>
<h3 id="if-expressions-if-表达式"><a class="header" href="#if-expressions-if-表达式"><code>if</code> Expressions <code>if</code> 表达式</a></h3>
<p>An <code>if</code> expression allows you to branch your code depending on conditions. You
provide a condition and then state, “If this condition is met, run this block
of code. If the condition is not met, do not run this block of code.”</p>
<p><code>if</code> 表达式允许根据条件分支执行代码。你提供一个条件，然后声明：“如果满足此条件，则执行此代码块；如果不满足，则不执行此代码块。”</p>
<p>Create a new project called <em>branches</em> in your <em>projects</em> directory to explore
the <code>if</code> expression. In the <em>src/main.rs</em> file, input the following:</p>
<p>在 <em>projects</em> 目录下创建一个名为 <em>branches</em> 的新项目来探索 <code>if</code> 表达式。在 <em>src/main.rs</em> 文件中输入以下内容：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let number = 3;

    if number &lt; 5 {
        println!("condition was true");
    } else {
        println!("condition was false");
    }
}</code></pre></pre>
<p>All <code>if</code> expressions start with the keyword <code>if</code>, followed by a condition. In
this case, the condition checks whether or not the variable <code>number</code> has a
value less than 5. We place the block of code to execute if the condition is
<code>true</code> immediately after the condition inside curly brackets. Blocks of code
associated with the conditions in <code>if</code> expressions are sometimes called <em>arms</em>,
just like the arms in <code>match</code> expressions that we discussed in the “Comparing
the Guess to the Secret Number” section of Chapter 2.</p>
<p>所有 <code>if</code> 表达式都以关键字 <code>if</code> 开头，后跟一个条件。在本例中，条件检查变量 <code>number</code> 的值是否小于 5。我们将条件为 <code>true</code> 时要执行的代码块放在条件后的大括号内。与 <code>if</code> 表达式中条件关联的代码块有时被称为 <em>分支</em>（arms），类似于第 2 章“将猜测与秘密数字比较”一节中讨论的 <code>match</code> 表达式中的分支。</p>
<p>Optionally, we can also include an <code>else</code> expression, which we chose to do
here, to give the program an alternative block of code to execute should the
condition evaluate to <code>false</code>. If you don’t provide an <code>else</code> expression and
the condition is <code>false</code>, the program will just skip the <code>if</code> block and move on
to the next bit of code.</p>
<p>我们还可以选择包含一个 <code>else</code> 表达式（这里我们选择了这样做），以便在条件为 <code>false</code> 时提供替代执行的代码块。如果不提供 <code>else</code> 表达式且条件为 <code>false</code>，程序将跳过 <code>if</code> 块并继续执行后续代码。</p>
<p>Try running this code; you should see the following output:</p>
<p>尝试运行此代码；你将看到以下输出：</p>
<pre><code class="language-console">$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/branches`
condition was true
</code></pre>
<p>Let’s try changing the value of <code>number</code> to a value that makes the condition
<code>false</code> to see what happens:</p>
<p>让我们将 <code>number</code> 的值改为使条件为 <code>false</code> 的值，看看会发生什么：</p>
<pre><code class="language-rust ignore"><span class="boring">fn main() {
</span>    let number = 7;
<span class="boring">
</span><span class="boring">    if number &lt; 5 {
</span><span class="boring">        println!("condition was true");
</span><span class="boring">    } else {
</span><span class="boring">        println!("condition was false");
</span><span class="boring">    }
</span><span class="boring">}</span></code></pre>
<p>Run the program again, and look at the output:</p>
<p>再次运行程序，查看输出：</p>
<pre><code class="language-console">$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/branches`
condition was false
</code></pre>
<p>It’s also worth noting that the condition in this code <em>must</em> be a <code>bool</code>. If
the condition isn’t a <code>bool</code>, we’ll get an error. For example, try running the
following code:</p>
<p>另外值得注意的是，此代码中的条件<strong>必须</strong>是 <code>bool</code> 类型。如果条件不是 <code>bool</code> 类型，我们将收到错误。例如，尝试运行以下代码：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><code class="language-rust ignore does_not_compile">fn main() {
    let number = 3;

    if number {
        println!("number was three");
    }
}</code></pre>
<p>The <code>if</code> condition evaluates to a value of <code>3</code> this time, and Rust throws an
error:</p>
<p>这次 <code>if</code> 条件的值为 <code>3</code>，Rust 会抛出错误：</p>
<pre><code class="language-console">$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
error[E0308]: mismatched types
 --&gt; src/main.rs:4:8
  |
4 |     if number {
  |        ^^^^^^ expected `bool`, found integer

For more information about this error, try `rustc --explain E0308`.
error: could not compile `branches` (bin "branches") due to 1 previous error
</code></pre>
<p>The error indicates that Rust expected a <code>bool</code> but got an integer. Unlike
languages such as Ruby and JavaScript, Rust will not automatically try to
convert non-Boolean types to a Boolean. You must be explicit and always provide
<code>if</code> with a Boolean as its condition. If we want the <code>if</code> code block to run
only when a number is not equal to <code>0</code>, for example, we can change the <code>if</code>
expression to the following:</p>
<p>错误表明 Rust 期望一个 <code>bool</code> 但得到了整数。与 Ruby 和 JavaScript 等语言不同，Rust 不会自动尝试将非布尔类型转换为布尔类型。你必须明确地始终为 <code>if</code> 提供一个布尔条件。例如，如果我们希望仅当数字不等于 <code>0</code> 时才运行 <code>if</code> 代码块，可以将 <code>if</code> 表达式修改如下：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let number = 3;

    if number != 0 {
        println!("number was something other than zero");
    }
}</code></pre></pre>
<p>Running this code will print <code>number was something other than zero</code>.</p>
<p>运行此代码将打印 <code>number was something other than zero</code>。</p>
<h4 id="handling-multiple-conditions-with-else-if-使用-else-if-处理多重条件"><a class="header" href="#handling-multiple-conditions-with-else-if-使用-else-if-处理多重条件">Handling Multiple Conditions with <code>else if</code> 使用 <code>else if</code> 处理多重条件</a></h4>
<p>You can use multiple conditions by combining <code>if</code> and <code>else</code> in an <code>else if</code>
expression. For example:</p>
<p>通过组合 <code>if</code> 和 <code>else</code> 形成 <code>else if</code> 表达式，可以处理多个条件。例如：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}</code></pre></pre>
<p>This program has four possible paths it can take. After running it, you should
see the following output:</p>
<p>该程序有四种可能的执行路径。运行后，你将看到以下输出：</p>
<pre><code class="language-console">$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/branches`
number is divisible by 3
</code></pre>
<p>When this program executes, it checks each <code>if</code> expression in turn and executes
the first body for which the condition evaluates to <code>true</code>. Note that even
though 6 is divisible by 2, we don’t see the output <code>number is divisible by 2</code>,
nor do we see the <code>number is not divisible by 4, 3, or 2</code> text from the <code>else</code>
block. That’s because Rust only executes the block for the first <code>true</code>
condition, and once it finds one, it doesn’t even check the rest.</p>
<p>程序执行时，会依次检查每个 <code>if</code> 表达式，并执行第一个条件为 <code>true</code> 的分支体。注意，尽管 6 能被 2 整除，但我们既看不到输出 <code>number is divisible by 2</code>，也看不到 <code>else</code> 块中的 <code>number is not divisible by 4, 3, or 2</code> 的文本。这是因为 Rust 仅执行第一个条件为 <code>true</code> 的块，一旦找到，就不再检查其余条件。</p>
<p>Using too many <code>else if</code> expressions can clutter your code, so if you have more
than one, you might want to refactor your code. Chapter 6 describes a powerful
Rust branching construct called <code>match</code> for these cases.</p>
<p>使用过多的 <code>else if</code> 表达式会使代码混乱，因此如果有多个条件，可能需要重构代码。第 6 章将介绍 Rust 中一个强大的分支结构 <code>match</code> 来处理此类情况。</p>
<h4 id="using-if-in-a-let-statement-在-let-语句中使用-if"><a class="header" href="#using-if-in-a-let-statement-在-let-语句中使用-if">Using <code>if</code> in a <code>let</code> Statement 在 <code>let</code> 语句中使用 <code>if</code></a></h4>
<p>Because <code>if</code> is an expression, we can use it on the right side of a <code>let</code>
statement to assign the outcome to a variable, as in Listing 3-2.</p>
<p><span class="highlight">[note]因为 <code>if</code> 是一个表达式，所以我们可以将其用在 <code>let</code> 语句的右侧，将结果赋值给变量</span>，如示例 3-2 所示。</p>
<figure class="listing" id="listing-3-2">
<span class="file-name">Filename: src/main.rs</span>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let condition = true;
    let number = if condition { 5 } else { 6 };

    println!("The value of number is: {number}");
}</code></pre></pre>
<figcaption><a href="#listing-3-2">Listing 3-2</a>: Assigning the result of an <code>if</code> expression to a variable 将 <code>if</code> 表达式的结果赋值给变量</figcaption>
</figure>
<p>The <code>number</code> variable will be bound to a value based on the outcome of the <code>if</code>
expression. Run this code to see what happens:</p>
<p>变量 <code>number</code> 将根据 <code>if</code> 表达式的结果绑定一个值。运行此代码查看结果：</p>
<pre><code class="language-console">$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.30s
     Running `target/debug/branches`
The value of number is: 5
</code></pre>
<p>Remember that blocks of code evaluate to the last expression in them, and
numbers by themselves are also expressions. In this case, the value of the
whole <code>if</code> expression depends on which block of code executes. This means the
values that have the potential to be results from each arm of the <code>if</code> must be
the same type; in Listing 3-2, the results of both the <code>if</code> arm and the <code>else</code>
arm were <code>i32</code> integers. If the types are mismatched, as in the following
example, we’ll get an error:</p>
<p>记住，代码块的值由其最后一个表达式决定，而数字本身也是表达式。在本例中，整个 <code>if</code> 表达式的值取决于执行的代码块。这意味着 <code>if</code> 的每个分支可能返回的结果值必须是相同类型；在示例 3-2 中，<code>if</code> 分支和 <code>else</code> 分支的结果都是 <code>i32</code> 整数。如果类型不匹配，如下例所示，我们将得到错误：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><code class="language-rust ignore does_not_compile">fn main() {
    let condition = true;

    let number = if condition { 5 } else { "six" };

    println!("The value of number is: {number}");
}</code></pre>
<p>When we try to compile this code, we’ll get an error. The <code>if</code> and <code>else</code> arms
have value types that are incompatible, and Rust indicates exactly where to
find the problem in the program:</p>
<p>尝试编译此代码时，我们会得到一个错误。<code>if</code> 和 <code>else</code> 分支的值类型不兼容，Rust 明确指出了程序中问题所在的位置：</p>
<pre><code class="language-console">$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
error[E0308]: `if` and `else` have incompatible types
 --&gt; src/main.rs:4:44
  |
4 |     let number = if condition { 5 } else { "six" };
  |                                 -          ^^^^^ expected integer, found `&amp;str`
  |                                 |
  |                                 expected because of this

For more information about this error, try `rustc --explain E0308`.
error: could not compile `branches` (bin "branches") due to 1 previous error
</code></pre>
<p>The expression in the <code>if</code> block evaluates to an integer, and the expression in
the <code>else</code> block evaluates to a string. This won’t work because variables must
have a single type, and Rust needs to know at compile time what type the
<code>number</code> variable is, definitively. Knowing the type of <code>number</code> lets the
compiler verify the type is valid everywhere we use <code>number</code>. Rust wouldn’t be
able to do that if the type of <code>number</code> was only determined at runtime; the
compiler would be more complex and would make fewer guarantees about the code
if it had to keep track of multiple hypothetical types for any variable.</p>
<p><code>if</code> 块中的表达式计算为整数，而 <code>else</code> 块中的表达式计算为字符串。这是行不通的，因为变量必须有单一类型，且 Rust 需要在编译时确切知道变量 <code>number</code> 的类型。知道 <code>number</code> 的类型可以让编译器在使用 <code>number</code> 的任何地方验证类型是否有效。如果 <code>number</code> 的类型仅在运行时确定，Rust 就无法做到这一点；如果编译器必须跟踪任何变量的多种假设类型，它会变得更复杂，对代码的保证也会减少。</p>
<h3 id="repetition-with-loops-使用循环进行重复"><a class="header" href="#repetition-with-loops-使用循环进行重复">Repetition with Loops 使用循环进行重复</a></h3>
<p>It’s often useful to execute a block of code more than once. For this task,
Rust provides several <em>loops</em>, which will run through the code inside the loop
body to the end and then start immediately back at the beginning. To experiment
with loops, let’s make a new project called <em>loops</em>.</p>
<p>多次执行同一代码块通常很有用。为此，Rust 提供了几种<strong>循环</strong>（loops），它们会执行循环体中的代码直到结束，然后立即从头开始重新执行。为了试验循环，让我们创建一个名为 <em>loops</em> 的新项目。</p>
<p>Rust has three kinds of loops: <code>loop</code>, <code>while</code>, and <code>for</code>. Let’s try each one.</p>
<p>Rust 有三种循环：<code>loop</code>、<code>while</code> 和 <code>for</code>。让我们逐一尝试。</p>
<h4 id="repeating-code-with-loop-使用-loop-重复执行代码"><a class="header" href="#repeating-code-with-loop-使用-loop-重复执行代码">Repeating Code with <code>loop</code> 使用 <code>loop</code> 重复执行代码</a></h4>
<p>The <code>loop</code> keyword tells Rust to execute a block of code over and over again
forever or until you explicitly tell it to stop.</p>
<p><code>loop</code> 关键字告诉 Rust 重复执行一段代码，直到你显式告诉它停止。</p>
<p>As an example, change the <em>src/main.rs</em> file in your <em>loops</em> directory to look
like this:</p>
<p>例如，将 <em>loops</em> 目录中的 <em>src/main.rs</em> 文件修改如下：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><code class="language-rust ignore">fn main() {
    loop {
        println!("again!");
    }
}</code></pre>
<p>When we run this program, we’ll see <code>again!</code> printed over and over continuously
until we stop the program manually. Most terminals support the keyboard shortcut
<kbd>ctrl</kbd>-<kbd>c</kbd> to interrupt a program that is stuck in a continual
loop. Give it a try:</p>
<p>运行此程序时，我们将看到 <code>again!</code> 被重复打印，直到手动停止程序。大多数终端支持键盘快捷键 <kbd>ctrl</kbd>-<kbd>c</kbd> 来中断陷入无限循环的程序。试试看：</p>
<pre><code class="language-console">$ cargo run
   Compiling loops v0.1.0 (file:///projects/loops)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.08s
     Running `target/debug/loops`
again!
again!
again!
again!
^Cagain!
</code></pre>
<p>The symbol <code>^C</code> represents where you pressed <kbd>ctrl</kbd>-<kbd>c</kbd>.</p>
<p>符号 <code>^C</code> 表示你按下 <kbd>ctrl</kbd>-<kbd>c</kbd> 的位置。</p>
<p>You may or may not see the word <code>again!</code> printed after the <code>^C</code>, depending on
where the code was in the loop when it received the interrupt signal.</p>
<p>在 <code>^C</code> 之后，你可能会也可能不会看到单词 <code>again!</code>，这取决于循环接收到中断信号时代码执行的位置。</p>
<p>Fortunately, Rust also provides a way to break out of a loop using code. You
can place the <code>break</code> keyword within the loop to tell the program when to stop
executing the loop. Recall that we did this in the guessing game in the
“Quitting After a Correct Guess” section of Chapter 2 to exit the program when the user won the game by
guessing the correct number.</p>
<p>幸运的是，Rust 也提供了通过代码跳出循环的方法。你可以在循环中放置 <code>break</code> 关键字，告诉程序何时停止执行循环。回想一下，我们在第 2 章“在正确猜测后退出”一节的猜谜游戏中这样做了，当用户猜中正确数字赢得游戏时退出程序。</p>
<p>We also used <code>continue</code> in the guessing game, which in a loop tells the program
to skip over any remaining code in this iteration of the loop and go to the
next iteration.</p>
<p>在猜谜游戏中我们还使用了 <code>continue</code>，它在循环中告诉程序跳过本次循环中剩余的代码，直接进入下一次迭代。</p>
<h4 id="returning-values-from-loops-从循环返回值"><a class="header" href="#returning-values-from-loops-从循环返回值">Returning Values from Loops 从循环返回值</a></h4>
<p>One of the uses of a <code>loop</code> is to retry an operation you know might fail, such
as checking whether a thread has completed its job. You might also need to pass
the result of that operation out of the loop to the rest of your code. To do
this, you can add the value you want returned after the <code>break</code> expression you
use to stop the loop; that value will be returned out of the loop so you can
use it, as shown here:</p>
<p><code>loop</code> 的一个用途是重试可能失败的操作，例如检查线程是否已完成其任务。你可能还需要将该操作的结果传递到循环外部给其余代码使用。为此，你可以<span class="highlight">[note]在用于停止循环的 <code>break</code> 表达式后添加要返回的值；该值将被返回出循环</span>，以便你使用，如下所示：</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {result}");
}</code></pre></pre>
<p>Before the loop, we declare a variable named <code>counter</code> and initialize it to
<code>0</code>. Then we declare a variable named <code>result</code> to hold the value returned from
the loop. On every iteration of the loop, we add <code>1</code> to the <code>counter</code> variable,
and then check whether the <code>counter</code> is equal to <code>10</code>. When it is, we use the
<code>break</code> keyword with the value <code>counter * 2</code>. After the loop, we use a
semicolon to end the statement that assigns the value to <code>result</code>. Finally, we
print the value in <code>result</code>, which in this case is <code>20</code>.</p>
<p>在循环之前，我们声明了一个名为 <code>counter</code> 的变量并将其初始化为 <code>0</code>。然后声明一个名为 <code>result</code> 的变量来保存循环返回的值。在每次循环迭代中，我们将 <code>counter</code> 变量加 <code>1</code>，然后检查 <code>counter</code> 是否等于 <code>10</code>。当条件满足时，我们使用值 <code>counter * 2</code> 执行 <code>break</code>。循环之后，我们用分号结束赋值给 <code>result</code> 的语句。最后，我们打印 <code>result</code> 的值，本例中为 <code>20</code>。</p>
<p>You can also <code>return</code> from inside a loop. While <code>break</code> only exits the current
loop, <code>return</code> always exits the current function.</p>
<p>你也可以在循环内部使用 <code>return</code>。虽然 <code>break</code> 仅退出当前循环，但 <code>return</code> 总是退出当前函数。</p>
<h4 id="loop-labels-to-disambiguate-between-multiple-loops-循环标签消除多个循环间的歧义"><a class="header" href="#loop-labels-to-disambiguate-between-multiple-loops-循环标签消除多个循环间的歧义">Loop Labels to Disambiguate Between Multiple Loops 循环标签消除多个循环间的歧义</a></h4>
<p>If you have loops within loops, <code>break</code> and <code>continue</code> apply to the innermost
loop at that point. You can optionally specify a <em>loop label</em> on a loop that
you can then use with <code>break</code> or <code>continue</code> to specify that those keywords
apply to the labeled loop instead of the innermost loop. Loop labels must begin
with a single quote. Here’s an example with two nested loops:</p>
<p>如果存在嵌套循环，<code>break</code> 和 <code>continue</code> 默认作用于最内层循环。你可以选择在循环上指定一个<strong>循环标签</strong>（loop label），然后与 <code>break</code> 或 <code>continue</code> 一起使用，以指定这些关键字应用于带标签的循环而非最内层循环。<span class="highlight">[note]循环标签必须以单引号开头</span>。下面是一个包含两个嵌套循环的示例：</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut count = 0;
    'counting_up: loop {
        println!("count = {count}");
        let mut remaining = 10;

        loop {
            println!("remaining = {remaining}");
            if remaining == 9 {
                break;
            }
            if count == 2 {
                break 'counting_up;
            }
            remaining -= 1;
        }

        count += 1;
    }
    println!("End count = {count}");
}</code></pre></pre>
<p>The outer loop has the label <code>'counting_up</code>, and it will count up from 0 to 2.
The inner loop without a label counts down from 10 to 9. The first <code>break</code> that
doesn’t specify a label will exit the inner loop only. The <code>break  'counting_up;</code> statement will exit the outer loop. This code prints:</p>
<p>外层循环带有标签 <code>'counting_up</code>，它将从 0 计数到 2。没有标签的内层循环从 10 倒数到 9。未指定标签的第一个 <code>break</code> 将仅退出内层循环。<code>break 'counting_up;</code> 语句将退出外层循环。此代码打印：</p>
<pre><code class="language-console">$ cargo run
   Compiling loops v0.1.0 (file:///projects/loops)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.58s
     Running `target/debug/loops`
count = 0
remaining = 10
remaining = 9
count = 1
remaining = 10
remaining = 9
count = 2
remaining = 10
End count = 2
</code></pre>
<h4 id="conditional-loops-with-while-使用-while-进行条件循环"><a class="header" href="#conditional-loops-with-while-使用-while-进行条件循环">Conditional Loops with <code>while</code> 使用 <code>while</code> 进行条件循环</a></h4>
<p>A program will often need to evaluate a condition within a loop. While the
condition is <code>true</code>, the loop runs. When the condition ceases to be <code>true</code>, the
program calls <code>break</code>, stopping the loop. It’s possible to implement behavior
like this using a combination of <code>loop</code>, <code>if</code>, <code>else</code>, and <code>break</code>; you could
try that now in a program, if you’d like. However, this pattern is so common
that Rust has a built-in language construct for it, called a <code>while</code> loop. In
Listing 3-3, we use <code>while</code> to loop the program three times, counting down each
time, and then, after the loop, print a message and exit.</p>
<p>程序通常需要在循环中评估条件。当条件为 <code>true</code> 时，循环运行；当条件不再为 <code>true</code> 时，程序调用 <code>break</code> 停止循环。你可以使用 <code>loop</code>、<code>if</code>、<code>else</code> 和 <code>break</code> 的组合来实现这种行为；如果愿意，可以尝试在程序中实现。然而，这种模式非常常见，因此 Rust 内置了一个语言结构，称为 <code>while</code> 循环。在示例 3-3 中，我们使用 <code>while</code> 循环程序三次，每次倒计时，然后在循环后打印消息并退出。</p>
<figure class="listing" id="listing-3-3">
<span class="file-name">Filename: src/main.rs</span>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{number}!");

        number -= 1;
    }

    println!("LIFTOFF!!!");
}</code></pre></pre>
<figcaption><a href="#listing-3-3">Listing 3-3</a>: Using a <code>while</code> loop to run code while a condition evaluates to <code>true</code> 使用 <code>while</code> 循环在条件为 <code>true</code> 时运行代码</figcaption>
</figure>
<p>This construct eliminates a lot of nesting that would be necessary if you used
<code>loop</code>, <code>if</code>, <code>else</code>, and <code>break</code>, and it’s clearer. While a condition
evaluates to <code>true</code>, the code runs; otherwise, it exits the loop.</p>
<p>这种结构消除了使用 <code>loop</code>、<code>if</code>、<code>else</code> 和 <code>break</code> 时可能产生的大量嵌套，使代码更清晰。当条件为 <code>true</code> 时，代码运行；否则，它退出循环。</p>
<h4 id="looping-through-a-collection-with-for-使用-for-遍历集合"><a class="header" href="#looping-through-a-collection-with-for-使用-for-遍历集合">Looping Through a Collection with <code>for</code> 使用 <code>for</code> 遍历集合</a></h4>
<p>You can choose to use the <code>while</code> construct to loop over the elements of a
collection, such as an array. For example, the loop in Listing 3-4 prints each
element in the array <code>a</code>.</p>
<p>你可以选择使用 <code>while</code> 结构来遍历集合（例如数组）的元素。例如，示例 3-4 中的循环打印数组 <code>a</code> 的每个元素。</p>
<figure class="listing" id="listing-3-4">
<span class="file-name">Filename: src/main.rs</span>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let a = [10, 20, 30, 40, 50];
    let mut index = 0;

    while index &lt; 5 {
        println!("the value is: {}", a[index]);

        index += 1;
    }
}</code></pre></pre>
<figcaption><a href="#listing-3-4">Listing 3-4</a>: Looping through each element of a collection using a <code>while</code> loop 使用 <code>while</code> 循环遍历集合的每个元素</figcaption>
</figure>
<p>Here, the code counts up through the elements in the array. It starts at index
<code>0</code>, and then loops until it reaches the final index in the array (that is,
when <code>index &lt; 5</code> is no longer <code>true</code>). Running this code will print every
element in the array:</p>
<p>此代码遍历数组中的元素。它从索引 <code>0</code> 开始，循环直到到达数组的最后一个索引（即当 <code>index &lt; 5</code> 不再为 <code>true</code> 时）。运行此代码将打印数组中的每个元素：</p>
<pre><code class="language-console">$ cargo run
   Compiling loops v0.1.0 (file:///projects/loops)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.32s
     Running `target/debug/loops`
the value is: 10
the value is: 20
the value is: 30
the value is: 40
the value is: 50
</code></pre>
<p>All five array values appear in the terminal, as expected. Even though <code>index</code>
will reach a value of <code>5</code> at some point, the loop stops executing before trying
to fetch a sixth value from the array.</p>
<p>所有五个数组值都如预期出现在终端中。即使 <code>index</code> 在某个时刻会达到值 <code>5</code>，循环也会在尝试从数组中获取第六个值之前停止执行。</p>
<p>However, this approach is error prone; we could cause the program to panic if
the index value or test condition is incorrect. For example, if you changed the
definition of the <code>a</code> array to have four elements but forgot to update the
condition to <code>while index &lt; 4</code>, the code would panic. It’s also slow, because
the compiler adds runtime code to perform the conditional check of whether the
index is within the bounds of the array on every iteration through the loop.</p>
<p>然而，这种方法容易出错；如果索引值或测试条件不正确，我们可能导致程序 panic。例如，如果将数组 <code>a</code> 的定义更改为包含四个元素，但忘记将条件更新为 <code>while index &lt; 4</code>，代码将 panic。这种方式也较慢，因为编译器在每次循环迭代时都会添加运行时代码来检查索引是否在数组边界内。</p>
<p>As a more concise alternative, you can use a <code>for</code> loop and execute some code
for each item in a collection. A <code>for</code> loop looks like the code in Listing 3-5.</p>
<p>作为更简洁的替代方案，你可以使用 <code>for</code> 循环来遍历集合并对每个元素执行代码。<code>for</code> 循环如示例 3-5 所示。</p>
<figure class="listing" id="listing-3-5">
<span class="file-name">Filename: src/main.rs</span>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("the value is: {element}");
    }
}</code></pre></pre>
<figcaption><a href="#listing-3-5">Listing 3-5</a>: Looping through each element of a collection using a <code>for</code> loop 使用 <code>for</code> 循环遍历集合的每个元素</figcaption>
</figure>
<p>When we run this code, we’ll see the same output as in Listing 3-4. More
importantly, we’ve now increased the safety of the code and eliminated the
chance of bugs that might result from going beyond the end of the array or not
going far enough and missing some items. Machine code generated from <code>for</code>
loops can be more efficient as well, because the index doesn’t need to be
compared to the length of the array at every iteration.</p>
<p>运行此代码时，我们将看到与示例 3-4 相同的输出。更重要的是，我们现在提高了代码的安全性，并消除了因超出数组末尾或未遍历足够元素而遗漏某些项所导致的错误可能性。<code>for</code> 循环生成的机器代码也可能更高效，因为索引在每次迭代时不需要与数组长度进行比较。</p>
<p>Using the <code>for</code> loop, you wouldn’t need to remember to change any other code if
you changed the number of values in the array, as you would with the method
used in Listing 3-4.</p>
<p>使用 <code>for</code> 循环时，如果更改数组中值的数量，你不需要像示例 3-4 中的方法那样记住修改其他代码。</p>
<p>The safety and conciseness of <code>for</code> loops make them the most commonly used loop
construct in Rust. Even in situations in which you want to run some code a
certain number of times, as in the countdown example that used a <code>while</code> loop
in Listing 3-3, most Rustaceans would use a <code>for</code> loop. The way to do that
would be to use a <code>Range</code>, provided by the standard library, which generates
all numbers in sequence starting from one number and ending before another
number.</p>
<p><code>for</code> 循环的安全性和简洁性使其成为 Rust 中最常用的循环结构。即使在你需要运行代码特定次数的情况下（如示例 3-3 中使用 <code>while</code> 循环的倒计时示例），大多数 Rust 开发者也会使用 <code>for</code> 循环。实现方式是<span class="highlight">[note]使用标准库提供的 <code>Range</code>，它生成从一个数字开始到另一个数字之前结束的所有连续数字</span>。</p>
<p>Here’s what the countdown would look like using a <code>for</code> loop and another method
we’ve not yet talked about, <code>rev</code>, to reverse the range:</p>
<p>以下是使用 <code>for</code> 循环和我们尚未讨论的另一个方法 <code>rev</code>（用于反转范围）来实现的倒计时：</p>
<p><span class="filename">Filename: src/main.rs</span></p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    for number in (1..4).rev() {
        println!("{number}!");
    }
    println!("LIFTOFF!!!");
}</code></pre></pre>
<p>This code is a bit nicer, isn’t it?</p>
<p>这段代码更简洁，不是吗？</p>
<h2 id="summary-总结"><a class="header" href="#summary-总结">Summary 总结</a></h2>
<p>You made it! This was a sizable chapter: you learned about variables, scalar
and compound data types, functions, comments, <code>if</code> expressions, and loops! To
practice with the concepts discussed in this chapter, try building programs to
do the following:</p>
<p>你做到了！这是一个相当长的章节：你学习了变量、标量和复合数据类型、函数、注释、<code>if</code> 表达式以及循环！为了练习本章讨论的概念，尝试编写程序来完成以下任务：</p>
<ul>
<li>Convert temperatures between Fahrenheit and Celsius.</li>
<li>在摄氏度和华氏度之间转换温度。</li>
<li>Generate the <em>n</em>th Fibonacci number.</li>
<li>生成第 <em>n</em> 个斐波那契数。</li>
<li>Print the lyrics to the Christmas carol “The Twelve Days of Christmas,”
taking advantage of the repetition in the song.</li>
<li>利用歌曲中的重复性，打印圣诞颂歌《圣诞节的十二天》的歌词。</li>
</ul>
<p>When you’re ready to move on, we’ll talk about a concept in Rust that <em>doesn’t</em>
commonly exist in other programming languages: ownership.</p>
<p>当你准备好继续前进时，我们将讨论 Rust 中一个<strong>不</strong>常见于其他编程语言的概念：所有权。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch03-04-comments.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch04-00-understanding-ownership.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch03-04-comments.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch04-00-understanding-ownership.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="ferris.js"></script>



    </div>
    </body>
</html>
